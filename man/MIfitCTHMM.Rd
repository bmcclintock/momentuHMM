% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MIfitCTHMM.R
\name{MIfitCTHMM}
\alias{MIfitCTHMM}
\alias{MIfitCTHMM.default}
\alias{MIfitCTHMM.hierarchical}
\title{Fit continuous-time multivariate HMMs to multiple imputation data}
\usage{
MIfitCTHMM(miData, ...)

\method{MIfitCTHMM}{default}(
  miData,
  nSims,
  ncores = 1,
  poolEstimates = TRUE,
  alpha = 0.95,
  na.rm = FALSE,
  Time.name = "time",
  Time.unit = "auto",
  CTDS = FALSE,
  nbStates,
  dist,
  Par0,
  beta0 = NULL,
  delta0 = NULL,
  estAngleMean = NULL,
  circularAngleMean = NULL,
  formula = ~1,
  formulaDelta = NULL,
  stationary = FALSE,
  mixtures = 1,
  formulaPi = NULL,
  nlmPar = NULL,
  fit = TRUE,
  useInitial = FALSE,
  DM = NULL,
  userBounds = NULL,
  workBounds = NULL,
  betaCons = NULL,
  deltaCons = NULL,
  mvnCoords = NULL,
  stateNames = NULL,
  knownStates = NULL,
  fixPar = NULL,
  retryFits = 0,
  retrySD = NULL,
  optMethod = "nlm",
  control = list(),
  prior = NULL,
  modelName = NULL,
  kappa = Inf,
  covNames = NULL,
  spatialCovs = NULL,
  centers = NULL,
  centroids = NULL,
  angleCovs = NULL,
  altCoordNames = NULL,
  gradient = FALSE,
  smoothGradient = FALSE,
  weights = c(1/2, 1/8, 1/8, 1/8, 1/8),
  scaleGrad = NULL,
  method = "IS",
  parIS = 1000,
  dfSim = Inf,
  grid.eps = 1,
  crit = 2.5,
  scaleSim = 1,
  quad.ask = FALSE,
  force.quad = TRUE,
  fullPost = TRUE,
  dfPostIS = Inf,
  scalePostIS = 1,
  thetaSamp = NULL,
  export = NULL,
  rast,
  directions = 4,
  zero.idx = integer(),
  interpMethod = "ShortestPath",
  spatialCovs.grad = NULL,
  crw = TRUE,
  normalize.gradients = FALSE,
  grad.point.decreasing = FALSE,
  ...
)

\method{MIfitCTHMM}{hierarchical}(
  miData,
  nSims,
  ncores = 1,
  poolEstimates = TRUE,
  alpha = 0.95,
  na.rm = FALSE,
  Time.name = "time",
  Time.unit = "auto",
  CTDS = FALSE,
  hierStates,
  hierDist,
  Par0,
  hierBeta = NULL,
  hierDelta = NULL,
  estAngleMean = NULL,
  circularAngleMean = NULL,
  hierFormula = NULL,
  hierFormulaDelta = NULL,
  mixtures = 1,
  formulaPi = NULL,
  nlmPar = NULL,
  fit = TRUE,
  useInitial = FALSE,
  DM = NULL,
  userBounds = NULL,
  workBounds = NULL,
  betaCons = NULL,
  deltaCons = NULL,
  mvnCoords = NULL,
  knownStates = NULL,
  fixPar = NULL,
  retryFits = 0,
  retrySD = NULL,
  optMethod = "nlm",
  control = list(),
  prior = NULL,
  modelName = NULL,
  kappa = Inf,
  covNames = NULL,
  spatialCovs = NULL,
  centers = NULL,
  centroids = NULL,
  angleCovs = NULL,
  altCoordNames = NULL,
  gradient = FALSE,
  smoothGradient = FALSE,
  weights = c(1/2, 1/8, 1/8, 1/8, 1/8),
  scaleGrad = NULL,
  method = "IS",
  parIS = 1000,
  dfSim = Inf,
  grid.eps = 1,
  crit = 2.5,
  scaleSim = 1,
  quad.ask = FALSE,
  force.quad = TRUE,
  fullPost = TRUE,
  dfPostIS = Inf,
  scalePostIS = 1,
  thetaSamp = NULL,
  export = NULL,
  rast,
  directions = 4,
  zero.idx = integer(),
  interpMethod = "ShortestPath",
  spatialCovs.grad = NULL,
  crw = TRUE,
  normalize.gradients = FALSE,
  grad.point.decreasing = FALSE,
  ...
)
}
\arguments{
\item{miData}{A \code{\link{crwData}} object, a \code{\link{crwHierData}} object, a \code{\link{crwSim}} object, a \code{\link{crwHierSim}} object, a list of \code{\link{momentuHMMData}} objects, or a list of \code{\link{momentuHierHMMData}} objects.}

\item{...}{further arguments passed to or from other methods}

\item{nSims}{Number of imputations in which to fit the HMM using \code{\link{fitCTHMM}}. If \code{miData} is a list of \code{momentuHMMData} 
objects, \code{nSims} cannot exceed the length of \code{miData}.}

\item{ncores}{Number of cores to use for parallel processing. Default: 1 (no parallel processing).}

\item{poolEstimates}{Logical indicating whether or not to calculate pooled parameter estimates across the \code{nSims} imputations using \code{\link{MIpool}}. Default: \code{TRUE}.}

\item{alpha}{Significance level for calculating confidence intervals of pooled estimates when \code{poolEstimates=TRUE} (see \code{\link{MIpool}}). Default: 0.95.}

\item{na.rm}{Logical indicating whether or not to exclude model fits with \code{NA} parameter estimates or standard errors from pooling when \code{poolEstimates=TRUE} (see \code{\link{MIpool}}). Default: FALSE.}

\item{Time.name}{Character string indicating name of the time column. Default: 'time'. Ignored if \code{miData} is a \code{crwData} object.}

\item{Time.unit}{Character string indicating units for time difference between observations (e.g. 'auto', 'secs', 'mins', 'hours', 'days', 'weeks'). Ignored unless \code{data[[Time.name]]} is of class \code{\link[base]{date-time}} or \code{\link[base]{date}}. Default: 'auto'.}

\item{CTDS}{Logical indicating whether multiple imputation location data should be prepared for a continuous-time, discrete-space analysis. See \code{\link{prepCTDS}}. Default: \code{FALSE}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{nbStates}{Number of states of the HMM. See \code{\link{fitCTHMM}}.}

\item{dist}{A named list indicating the probability distributions of the data streams. See \code{\link{fitCTHMM}}.}

\item{Par0}{A named list containing vectors of initial state-dependent probability distribution parameters for 
each data stream specified in \code{dist}. See \code{\link{fitCTHMM}}.  \code{Par0} may also be a list of length \code{nSims}, where each element is a named list containing vectors
of initial state-dependent probability distribution parameters for each imputation. Note that if \code{useInitial=TRUE} then \code{Par0} is ignored after the first imputation.}

\item{beta0}{Initial matrix of regression coefficients for the transition probabilities. See \code{\link{fitCTHMM}}. \code{beta0} may also be a list of length \code{nSims}, where each element 
is an initial matrix of regression coefficients for the transition probabilities for each imputation.}

\item{delta0}{Initial values for the initial distribution of the HMM. See \code{\link{fitCTHMM}}. \code{delta0} may also be a list of length \code{nSims}, where each element 
is the initial values for the initial distribution of the HMM for each imputation.}

\item{estAngleMean}{An optional named list indicating whether or not to estimate the angle mean for data streams with angular 
distributions ('vm' and 'wrpcauchy'). See \code{\link{fitCTHMM}}.}

\item{circularAngleMean}{An optional named list indicating whether to use circular-linear or circular-circular
regression on the mean of circular distributions ('vm' and 'wrpcauchy') for turning angles. See \code{\link{fitCTHMM}}.}

\item{formula}{Regression formula for the transition probability covariates. See \code{\link{fitCTHMM}}.}

\item{formulaDelta}{Regression formula for the initial distribution. See \code{\link{fitCTHMM}}.}

\item{stationary}{\code{FALSE} if there are time-varying covariates in \code{formula} or any covariates in \code{formulaDelta}. If \code{TRUE}, the initial distribution is considered
equal to the stationary distribution. See \code{\link{fitCTHMM}}.}

\item{mixtures}{Number of mixtures for the state transition probabilities  (i.e. discrete random effects *sensu* DeRuiter et al. 2017). Default: \code{mixtures=1}.}

\item{formulaPi}{Regression formula for the mixture distribution probabilities. See \code{\link{fitCTHMM}}.}

\item{nlmPar}{List of parameters to pass to the optimization function \code{\link[stats]{nlm}} (which should be either
\code{print.level}, \code{gradtol}, \code{stepmax}, \code{steptol}, \code{iterlim}, or \code{hessian} -- see \code{nlm}'s documentation
for more detail). For \code{print.level}, the default value of 0 means that no
printing occurs, a value of 1 means that the first and last iterations of the optimization are
detailed, and a value of 2 means that each iteration of the optimization is detailed. Ignored unless \code{optMethod="nlm"}.}

\item{fit}{\code{TRUE} if the HMM should be fitted to the data, \code{FALSE} otherwise. See \code{\link{fitCTHMM}}. If \code{fit=FALSE} and \code{miData} is a \code{\link{crwData}}
object, then \code{MIfitCTHMM} returns a list containing a \code{\link{momentuHMMData}} object (if \code{nSims=1}) or, if \code{nSims>1}, a \code{\link{crwSim}} object.}

\item{useInitial}{Logical indicating whether or not to use parameter estimates for the first model fit as initial values for all subsequent model fits.
If \code{ncores>1} then the first model is fit on a single core and then used as the initial values for all subsequent model fits on each core 
(in this case, the progress of the initial model fit can be followed using the \code{print.level} option in \code{nlmPar}). Default: FALSE. Ignored if \code{nSims<2}.}

\item{DM}{An optional named list indicating the design matrices to be used for the probability distribution parameters of each data 
stream. See \code{\link{fitCTHMM}}.}

\item{userBounds}{An optional named list of 2-column matrices specifying bounds on the natural (i.e, real) scale of the probability 
distribution parameters for each data stream. See \code{\link{fitCTHMM}}.}

\item{workBounds}{An optional named list of 2-column matrices specifying bounds on the working scale of the probability distribution, transition probability, and initial distribution parameters. See \code{\link{fitCTHMM}}.}

\item{betaCons}{Matrix of the same dimension as \code{beta0} composed of integers identifying any equality constraints among the t.p.m. parameters. See \code{\link{fitCTHMM}}.}

\item{deltaCons}{Matrix of the same dimension as \code{delta0} composed of integers identifying any equality constraints among the initial distribution working scale parameters. Ignored unless a formula is provided in \code{formulaDelta}. See \code{\link{fitCTHMM}}.}

\item{mvnCoords}{Character string indicating the name of location data that are to be modeled using a multivariate normal distribution. For example, if \code{mu="mvnorm2"} was included in \code{dist} and (mu.x, mu.y) are location data, 
then \code{mvnCoords="mu"} needs to be specified in order for these data to be properly treated as locations in functions such as \code{\link{plot.momentuHMM}}, \code{\link{plot.miSum}}, \code{\link{plot.miHMM}}, \code{\link{plotSpatialCov}}, and \code{\link{MIpool}}.}

\item{stateNames}{Optional character vector of length nbStates indicating state names.}

\item{knownStates}{Vector of values of the state process which are known prior to fitting the
model (if any). See \code{\link{fitCTHMM}}. If \code{miData} is a list of \code{\link{momentuHMMData}} objects, then \code{knownStates} can alternatively
be a list of vectors containing the known values for the state process for each element of \code{miData}.}

\item{fixPar}{An optional list of vectors indicating parameters which are assumed known prior to fitting the model. See \code{\link{fitCTHMM}}.}

\item{retryFits}{Non-negative integer indicating the number of times to attempt to iteratively fit the model using random perturbations of the current parameter estimates as the 
initial values for likelihood optimization.  See \code{\link{fitCTHMM}}.}

\item{retrySD}{An optional list of scalars or vectors indicating the standard deviation to use for normal perturbations of each working scale parameter when \code{retryFits>0}. See \code{\link{fitCTHMM}}.}

\item{optMethod}{The optimization method to be used.  Can be ``nlm'' (the default; see \code{\link[stats]{nlm}}), ``TMB'' (using Template Model Builder; see \code{\link[optimx]{optimx}} for control parameters), ``Nelder-Mead'' (see \code{\link[stats]{optim}}), or ``SANN'' (see \code{\link[stats]{optim}}).}

\item{control}{A list of control parameters to be passed to \code{\link[stats]{optim}} (ignored unless \code{optMethod="TMB"}, \code{optMethod="Nelder-Mead"}, or \code{optMethod="SANN"}).}

\item{prior}{A function that returns the log-density of the working scale parameter prior distribution(s).  See \code{\link{fitCTHMM}}.}

\item{modelName}{An optional character string providing a name for the fitted model. If provided, \code{modelName} will be returned in \code{\link{print.momentuHMM}}, \code{\link{AIC.momentuHMM}}, \code{\link{AICweights}}, and other functions.}

\item{kappa}{maximum allowed value for the row sums of the off-diagonal elements in the state transition rate matrix, such that the minimum value for the diagonal elements is \code{-kappa}. Default: \code{Inf}. Setting less than \code{Inf} can help avoid numerical issues during optimization, in which case the transition rate parameters \code{beta} are on the logit scale (instead of the log scale).}

\item{covNames}{Names of any covariates in \code{miData$crwPredict} (if \code{miData} is a \code{\link{crwData}} object; otherwise 
\code{covNames} is ignored). See \code{\link{prepData}}.}

\item{spatialCovs}{List of raster layer(s) for any spatial covariates. See \code{\link{prepData}}.}

\item{centers}{2-column matrix providing the x-coordinates (column 1) and y-coordinates (column 2) for any activity centers (e.g., potential 
centers of attraction or repulsion) from which distance and angle covariates will be calculated based on realizations of the position process. 
See \code{\link{prepData}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{centroids}{List where each element is a data frame containing the x-coordinates ('x'), y-coordinates ('y'), and times (with user-specified name, e.g., `time') for centroids (i.e., dynamic activity centers where the coordinates can change over time)
from which distance and angle covariates will be calculated based on the location data. See \code{\link{prepData}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{angleCovs}{Character vector indicating the names of any circular-circular regression angular covariates in \code{miData$crwPredict} that need conversion from standard direction (in radians relative to the x-axis) to turning angle (relative to previous movement direction) 
See \code{\link{prepData}}. Ignored unless \code{miData} is a \code{\link{crwData}} or \code{\link{crwHierData}} object.}

\item{altCoordNames}{Character string indicating an alternative name for the returned location data. See \code{\link{prepData}}. Ignored unless \code{miData} is a \code{\link{crwData}} or \code{\link{crwHierData}} object.}

\item{gradient}{Logical indicating whether or not to calculate gradients of \code{spatialCovs} using bilinear interpolation (e.g. for inclusion in potential functions). Ignored unless \code{miData} is a \code{\link{crwData}} or \code{\link{crwHierData}} object. See \code{\link{prepData}}. Default: \code{FALSE}.}

\item{smoothGradient}{Logical indicating whether or not to calculate smoothed gradients. See \code{\link{addSmoothGradient}}. Ignored unless \code{gradient=TRUE}. Default: \code{FALSE}.}

\item{weights}{Numeric vector indicating the weight for the points in a smoothed version of the gradient. See \code{\link{addSmoothGradient}}. Ignored unless \code{smoothGradient=TRUE}. Default: \code{c(1/2, 1/8, 1/8, 1/8, 1/8)}.}

\item{scaleGrad}{Numeric scalar indicating the distance from the observed location to each smoothing point (before adjusting by time step). See \code{\link{addSmoothGradient}}. Ignored unless \code{smoothGradient=TRUE}.}

\item{method}{Method for obtaining weights for movement parameter samples. See \code{\link[crawl]{crwSimulator}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{parIS}{Size of the parameter importance sample. See \code{\link[crawl]{crwSimulator}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{dfSim}{Degrees of freedom for the t approximation to the parameter posterior. See 'df' argument in \code{\link[crawl]{crwSimulator}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{grid.eps}{Grid size for \code{method="quadrature"}. See \code{\link[crawl]{crwSimulator}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{crit}{Criterion for deciding "significance" of quadrature points
(difference in log-likelihood). See \code{\link[crawl]{crwSimulator}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{scaleSim}{Scale multiplier for the covariance matrix of the t approximation. See 'scale' argument in \code{\link[crawl]{crwSimulator}}. 
Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{quad.ask}{Logical, for method='quadrature'. Whether or not the sampler should ask if quadrature sampling should take place. It is used to stop the sampling if the number of likelihood evaluations would be extreme. Default: FALSE. Ignored if \code{ncores>1}.}

\item{force.quad}{A logical indicating whether or not to force the execution 
of the quadrature method for large parameter vectors. See \code{\link[crawl]{crwSimulator}}. Default: TRUE. Ignored unless \code{miData} is a \code{\link{crwData}} object and \code{method=``quadrature''}.}

\item{fullPost}{Logical indicating whether to draw parameter values as well to simulate full posterior. See \code{\link[crawl]{crwPostIS}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{dfPostIS}{Degrees of freedom for multivariate t distribution approximation to parameter posterior. See 'df' argument in \code{\link[crawl]{crwPostIS}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{scalePostIS}{Extra scaling factor for t distribution approximation. See 'scale' argument in \code{\link[crawl]{crwPostIS}}. Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{thetaSamp}{If multiple parameter samples are available in \code{\link[crawl]{crwSimulator}} objects,
setting \code{thetaSamp=n} will use the nth sample. Defaults to the last. See \code{\link[crawl]{crwSimulator}} and \code{\link[crawl]{crwPostIS}}. 
Ignored unless \code{miData} is a \code{\link{crwData}} object.}

\item{export}{Character vector of the names of any additional objects or functions in the global environment that are used in \code{DM}, \code{formula}, \code{formulaDelta}, and/or \code{formulaPi}. Only necessary if \code{ncores>1} so that the needed items will be exported to the workers.}

\item{rast}{A raster object or raster stack object that will define the discrete-space grid cells for the CTDS movement path. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{directions}{Integer. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{zero.idx}{Integer vector of the indices of raster cells that are not passable and should be excluded. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{interpMethod}{Specifies interpolation method. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{spatialCovs.grad}{List of \code{\link[raster]{raster}} objects for spatio-temporally referenced covariates, where a directional gradient is to be calculated internally using \code{\link[ctmcmove]{rast.grad}}. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{crw}{Logical. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{normalize.gradients}{Logical. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{grad.point.decreasing}{Logical. See \code{\link{prepCTDS}}. Ignored unless \code{miData} is a \code{crwData} object and \code{CTDS} is \code{TRUE}.}

\item{hierStates}{A hierarchical model structure \code{\link[data.tree]{Node}} for the states.  See \code{\link{fitCTHMM}}.}

\item{hierDist}{A hierarchical data structure \code{\link[data.tree]{Node}} for the data streams. See \code{\link{fitCTHMM}}.}

\item{hierBeta}{A hierarchical data structure \code{\link[data.tree]{Node}} for the matrix of initial values for the regression coefficients of the transition probabilities at each level of the hierarchy ('beta'). See \code{\link{fitCTHMM}}.}

\item{hierDelta}{A hierarchical data structure \code{\link[data.tree]{Node}} for the matrix of initial values for the regression coefficients of the initial distribution at each level of the hierarchy ('delta'). See \code{\link{fitCTHMM}}.}

\item{hierFormula}{A hierarchical formula structure for the transition probability covariates for each level of the hierarchy. See \code{\link{fitCTHMM}}.}

\item{hierFormulaDelta}{A hierarchical formula structure for the initial distribution covariates for each level of the hierarchy ('formulaDelta'). Default: \code{NULL} (no covariate effects and \code{fixPar$delta} is specified on the working scale). See \code{\link{fitCTHMM}}.}
}
\value{
If \code{nSims>1}, \code{poolEstimates=TRUE}, and \code{fit=TRUE}, a \code{\link{miHMM}} object, i.e., a list consisting of:
\item{miSum}{\code{\link{miSum}} object returned by \code{\link{MIpool}}.}
\item{HMMfits}{List of length \code{nSims} comprised of \code{\link{momentuHMM}} objects.}
If \code{poolEstimates=FALSE} and \code{fit=TRUE}, a list of length \code{nSims} consisting of \code{\link{momentuHMM}} objects is returned. 

However, if \code{fit=FALSE} and \code{miData} is a \code{\link{crwData}} 
object, then \code{MIfitCTHMM} returns a \code{\link{crwSim}} object, i.e., a list containing \code{miData} (a list of 
\code{\link{momentuHMMData}} objects) and \code{crwSimulator} (a list of \code{\link[crawl]{crwSimulator}} objects),and most other arguments related to \code{\link{fitCTHMM}} are ignored.
}
\description{
Fit an approximate continuous-time (multivariate) hidden Markov model to multiple imputation data. Multiple imputation is a method for accommodating 
missing data, temporal-irregularity, or location measurement error in hidden Markov models, where pooled parameter estimates reflect uncertainty
attributable to observation error. The discrete-time approximation of the continuous-time model improves as the time between observations decreases. 
Note that any time-varying covariates are assumed piece-wise constant between observations.
}
\details{
\code{miData} can either be a \code{\link{crwData}} or \code{\link{crwHierData}} object (as returned by \code{\link{crawlWrap}}), a \code{\link{crwSim}} or \code{\link{crwHierSim}} object (as returned by \code{MIfitCTHMM} when \code{fit=FALSE}), 
or a list of \code{\link{momentuHMMData}} or \code{\link{momentuHierHMMData}} objects (e.g., each element of the list as returned by \code{\link{prepData}}). 

If \code{miData} is a \code{crwData} (or \code{crwHierData}) object, \code{MIfitCTHMM} uses a combination of 
\code{\link[crawl]{crwSimulator}}, \code{\link[crawl]{crwPostIS}}, \code{\link{prepData}}, and \code{\link{fitCTHMM}} to draw \code{nSims} realizations of the position process
and fit the specified HMM to each imputation of the data. The vast majority of \code{MIfitCTHMM} arguments are identical to the corresponding arguments from these functions.

If \code{miData} is a \code{\link{crwData}} or \code{\link{crwHierData}} object, \code{nSims} determines both the number of realizations of the position process to draw 
(using \code{\link[crawl]{crwSimulator}} and \code{\link[crawl]{crwPostIS}}) as well as the number of HMM fits.

If \code{miData} is a \code{\link{crwSim}} (or \code{\link{crwHierSim}}) object or a list of \code{\link{momentuHMMData}} (or \code{\link{momentuHierHMMData}}) object(s), the specified HMM will simply be fitted to each of the \code{momentuHMMData} (or \code{momentuHierHMMData}) objects
and all arguments related to \code{\link[crawl]{crwSimulator}}, \code{\link[crawl]{crwPostIS}}, or \code{\link{prepData}} are ignored.

\code{fitCTHMM} assumes the snapshot property applies to all data stream distributions (i.e. observations are ``instantaneous'') except for the (multivariate) normal random walk (\code{rw_norm}, \code{rw_mvnorm2}, \code{rw_mvnorm3}) and Poisson (\code{pois}) distributions. For these particular distributions, the observed data are not ``instantaneous''; they depend on the time interval between observations \eqn{(\Delta_t)} and, hence, the state sequence during the entire interval.
When fitting with \code{\link{fitCTHMM}} (or \code{\link{MIfitCTHMM}}), it is critical that the frequency of observations is high relative to the serial correlation in the hidden state process in order for the discrete-time approximation of \code{\link{fitCTHMM}} to be reasonably accurate for these distributions.
}
\references{
Hooten M.B., Johnson D.S., McClintock B.T., Morales J.M. 2017. Animal Movement: Statistical Models for Telemetry Data. CRC Press, Boca Raton.

McClintock B.T. 2017. Incorporating telemetry error into hidden Markov movement models using multiple imputation. Journal of Agricultural, Biological,
and Environmental Statistics.
}
\seealso{
\code{\link{crawlWrap}}, \code{\link[crawl]{crwPostIS}}, \code{\link[crawl]{crwSimulator}}, \code{\link{fitCTHMM}}, \code{\link{getParDM}}, \code{\link{MIpool}}, \code{\link{prepData}}, \code{\link{prepCTDS}}
}
